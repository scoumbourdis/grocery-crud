/*
 *
 * TableSorter 2.0 - Client-side table sorting with ease!
 * Version 2.0.5b
 * @requires jQuery v1.2.3
 *
 * Copyright (c) 2007 Christian Bach
 * Examples and docs at: http://tablesorter.com
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 */
(function(c){c.extend({tablesorter:new function(){function a(b,a){m(b+","+((new Date).getTime()-a.getTime())+"ms")}function m(b){"undefined"!=typeof console&&"undefined"!=typeof console.debug?console.log(b):alert(b)}function r(b,a){if(b.config.debug)var d="";if(0!=b.tBodies.length){var g=b.tBodies[0].rows;if(g[0])for(var f=[],h=g[0].cells.length,k=0;k<h;k++){var e=!1;c.metadata&&c(a[k]).metadata()&&c(a[k]).metadata().sorter?e=j(c(a[k]).metadata().sorter):b.config.headers[k]&&b.config.headers[k].sorter&&(e=j(b.config.headers[k].sorter));if(!e)a:{for(var e=b,n=g,p=-1,r=k,s=q.length,y=!1,t=!1,u=!0;""==t&&u;)p++,n[p]?(y=n[p].cells[r],t=c.trim(B(e.config,y)),e.config.debug&&m("Checking if value was empty on row:"+p)):u=!1;for(n=1;n<s;n++)if(q[n].is(t,e,y)){e=q[n];break a}e=q[0]}b.config.debug&&(d+="column:"+k+" parser:"+e.id+"\n");f.push(e)}b.config.debug&&m(d);return f}}function j(b){for(var a=q.length,d=0;d<a;d++)if(q[d].id.toLowerCase()==b.toLowerCase())return q[d];return!1}function s(b){if(b.config.debug)var l=new Date;for(var d=b.tBodies[0]&&b.tBodies[0].rows.length||0,g=b.tBodies[0].rows[0]&&b.tBodies[0].rows[0].cells.length||0,f=b.config.parsers,h={row:[],normalized:[]},k=0;k<d;++k){var e=c(b.tBodies[0].rows[k]),n=[];if(e.hasClass(b.config.cssChildRow))h.row[h.row.length-1]=h.row[h.row.length-1].add(e);else{h.row.push(e);for(var p=0;p<g;++p)n.push(f[p].format(B(b.config,e[0].cells[p]),b,e[0].cells[p]));n.push(h.normalized.length);h.normalized.push(n)}}b.config.debug&&a("Building cache for "+d+" rows:",l);return h}function B(b,a){var d="";if(!a)return"";b.supportsTextContent||(b.supportsTextContent=a.textContent||!1);return d="simple"==b.textExtraction?b.supportsTextContent?a.textContent:a.childNodes[0]&&a.childNodes[0].hasChildNodes()?a.childNodes[0].innerHTML:a.innerHTML:"function"==typeof b.textExtraction?b.textExtraction(a):c(a).text()}function C(b,l){if(b.config.debug)var d=new Date;for(var g=l.row,f=l.normalized,h=f.length,k=f[0].length-1,e=c(b.tBodies[0]),n=[],p=0;p<h;p++){var m=f[p][k];n.push(g[m]);if(!b.config.appender)for(var r=g[m].length,j=0;j<r;j++)e[0].appendChild(g[m][j])}b.config.appender&&b.config.appender(b,n);n=null;b.config.debug&&a("Rebuilt table:",d);D(b);setTimeout(function(){c(b).trigger("sortEnd")},0)}function F(b,a){return b.config.headers[a]&&b.config.headers[a].lockedOrder?b.config.headers[a].lockedOrder:!1}function D(a){for(var c=a.config.widgets,d=c.length,g=0;g<d;g++)G(c[g]).format(a)}function G(a){for(var c=x.length,d=0;d<c;d++)if(x[d].id.toLowerCase()==a.toLowerCase())return x[d]}function H(a,l,d,g){l.removeClass(g[0]).removeClass(g[1]);var f=[];l.each(function(){this.sortDisabled||(f[this.column]=c(this))});a=d.length;for(l=0;l<a;l++)f[d[l][0]].addClass(g[d[l][1]])}function I(b,c,d){if(b.config.debug)var g=new Date;for(var f="var sortWrapper = function(a,b) {",h=c.length,k=0;k<h;k++)var e=c[k][0],n=c[k][1],e="text"==b.config.parsers[e].type?0==n?z("text","asc",e):z("text","desc",e):0==n?z("numeric","asc",e):z("numeric","desc",e),m="e"+k,f=f+("var "+m+" = "+e),f=f+("if("+m+") { return "+m+"; } "),f=f+"else { ";k=d.normalized[0].length-1;f+="return a["+k+"]-b["+k+"];";for(k=0;k<h;k++)f+="}; ";f+="return 0; }; ";b.config.debug&&a("Evaling expression:"+f,new Date);eval(f);d.normalized.sort(sortWrapper);b.config.debug&&a("Sorting on "+c.toString()+" and dir "+n+" time:",g);return d}function z(a,c,d){var g="a["+d+"]";d="b["+d+"]";if("text"==a&&"asc"==c)return"("+g+" == "+d+" ? 0 : ("+g+" === null ? Number.POSITIVE_INFINITY : ("+d+" === null ? Number.NEGATIVE_INFINITY : ("+g+" < "+d+") ? -1 : 1 )));";if("text"==a&&"desc"==c)return"("+g+" == "+d+" ? 0 : ("+g+" === null ? Number.POSITIVE_INFINITY : ("+d+" === null ? Number.NEGATIVE_INFINITY : ("+d+" < "+g+") ? -1 : 1 )));";if("numeric"==a&&"asc"==c)return"("+g+" === null && "+d+" === null) ? 0 :("+g+" === null ? Number.POSITIVE_INFINITY : ("+d+" === null ? Number.NEGATIVE_INFINITY : "+g+" - "+d+"));";if("numeric"==a&&"desc"==c)return"("+g+" === null && "+d+" === null) ? 0 :("+g+" === null ? Number.POSITIVE_INFINITY : ("+d+" === null ? Number.NEGATIVE_INFINITY : "+d+" - "+g+"));"}var q=[],x=[];this.defaults={cssHeader:"header",cssAsc:"headerSortUp",cssDesc:"headerSortDown",cssChildRow:"expand-child",sortInitialOrder:"asc",sortMultiSortKey:"shiftKey",sortForce:null,sortAppend:null,sortLocaleCompare:!0,textExtraction:"simple",parsers:{},widgets:[],widgetZebra:{css:["even","odd"]},headers:{},widthFixed:!1,cancelSelection:!0,sortList:[],headerList:[],dateFormat:"us",decimal:"/.|,/g",onRenderHeader:null,selectorHeaders:"thead th",noSorterClass:"no-sorter",debug:!1};this.benchmark=a;this.construct=function(b){return this.each(function(){if(this.tHead&&this.tBodies){var l,d,g,f;this.config={};f=c.extend(this.config,c.tablesorter.defaults,b);l=c(this);c.data(this,"tablesorter",f);var h=this;if(h.config.debug)var k=new Date;for(var e=[],n={},j=h.getElementsByTagName("THEAD")[0].getElementsByTagName("TR"),q=0;q<j.length;q++)for(var w=j[q].cells,y=0;y<w.length;y++){var t=w[y],u=t.parentNode.rowIndex,x=u+"-"+t.cellIndex,z=t.rowSpan||1,t=t.colSpan||1,A;"undefined"==typeof e[u]&&(e[u]=[]);for(var v=0;v<e[u].length+1;v++)if("undefined"==typeof e[u][v]){A=v;break}n[x]=A;for(v=u;v<u+z;v++){"undefined"==typeof e[v]&&(e[v]=[]);for(var x=e[v],E=A;E<A+t;E++)x[E]="x"}}$tableHeaders=c(h.config.selectorHeaders,h).each(function(a){this.column=n[this.parentNode.rowIndex+"-"+this.cellIndex];this.count=this.order="Number"!=typeof h.config.sortInitialOrder?"desc"==h.config.sortInitialOrder.toLowerCase()?1:0:1==h.config.sortInitialOrder?1:0;if(c.metadata&&!1===c(this).metadata().sorter||c(this).hasClass(h.config.noSorterClass)||h.config.headers[a]&&!1===h.config.headers[a].sorter)this.sortDisabled=!0;F(h,a)&&(this.order=this.lockedOrder=F(h,a));if(!this.sortDisabled){var b=c(this).addClass(h.config.cssHeader);h.config.onRenderHeader&&h.config.onRenderHeader.apply(b)}h.config.headerList[a]=this});h.config.debug&&(a("Built headers:",k),m($tableHeaders));d=$tableHeaders;this.config.parsers=r(this,d);g=s(this);var J=[f.cssDesc,f.cssAsc];if(this.config.widthFixed){var K=c("<colgroup>");c("tr:first td",this.tBodies[0]).each(function(){K.append(c("<col>").css("width",c(this).width()))});c(this).prepend(K)}d.click(function(a){var b=l[0].tBodies[0]&&l[0].tBodies[0].rows.length||0;if(!this.sortDisabled&&0<b){l.trigger("sortStart");c(this);b=this.column;this.order=this.count++%2;this.lockedOrder&&(this.order=this.lockedOrder);if(a[f.sortMultiSortKey]){a:{a=f.sortList;for(var e=a.length,h=0;h<e;h++)if(a[h][0]==b){a=!0;break a}a=!1}if(a)for(a=0;a<f.sortList.length;a++)e=f.sortList[a],h=f.headerList[e[0]],e[0]==b&&(h.count=e[1],h.count++,e[1]=h.count%2);else f.sortList.push([b,this.order])}else{f.sortList=[];if(null!=f.sortForce){e=f.sortForce;for(a=0;a<e.length;a++)e[a][0]!=b&&f.sortList.push(e[a])}f.sortList.push([b,this.order])}setTimeout(function(){H(l[0],d,f.sortList,J);C(l[0],I(l[0],f.sortList,g))},1);return!1}}).mousedown(function(){if(f.cancelSelection)return this.onselectstart=function(){return!1},!1});l.bind("update",function(){var a=this;setTimeout(function(){a.config.parsers=r(a,d);g=s(a)},1)}).bind("updateCell",function(a,b){var c=this.config,d=[b.parentNode.rowIndex-1,b.cellIndex];g.normalized[d[0]][d[1]]=c.parsers[d[1]].format(B(c,b),b)}).bind("sorton",function(a,b){c(this).trigger("sortStart");f.sortList=b;for(var e=f.sortList,h=this.config,k=e.length,m=0;m<k;m++){var l=e[m],n=h.headerList[l[0]];n.count=l[1];n.count++}H(this,d,e,J);C(this,I(this,e,g))}).bind("appendCache",function(){C(this,g)}).bind("applyWidgetId",function(a,b){G(b).format(this)}).bind("applyWidgets",function(){D(this)});c.metadata&&(c(this).metadata()&&c(this).metadata().sortlist)&&(f.sortList=c(this).metadata().sortlist);0<f.sortList.length&&l.trigger("sorton",[f.sortList]);D(this)}})};this.addParser=function(a){for(var c=q.length,d=!0,g=0;g<c;g++)q[g].id.toLowerCase()==a.id.toLowerCase()&&(d=!1);d&&q.push(a)};this.addWidget=function(a){x.push(a)};this.formatFloat=function(a){a=parseFloat(a);return isNaN(a)?0:a};this.formatInt=function(a){a=parseInt(a);return isNaN(a)?0:a};this.isDigit=function(a){return/^[-+]?\d*$/.test(c.trim(a.replace(/[,.']/g,"")))};this.clearTableBody=function(a){c.browser.msie?function(){for(;this.firstChild;)this.removeChild(this.firstChild)}.apply(a.tBodies[0]):a.tBodies[0].innerHTML=""}}});c.fn.extend({tablesorter:c.tablesorter.construct});var j=c.tablesorter;j.addParser({id:"text",is:function(){return!0},format:function(a){return c.trim(a.toLocaleLowerCase())},type:"text"});j.addParser({id:"digit",is:function(a,m){return c.tablesorter.isDigit(a,m.config)},format:function(a){return c.tablesorter.formatFloat(a)},type:"numeric"});j.addParser({id:"currency",is:function(a){return/^[\u00a3$\u20ac?.]/.test(a)},format:function(a){return c.tablesorter.formatFloat(a.replace(RegExp(/[\u00a3$\u20ac]/g),""))},type:"numeric"});j.addParser({id:"ipAddress",is:function(a){return/^\d{2,3}[\.]\d{2,3}[\.]\d{2,3}[\.]\d{2,3}$/.test(a)},format:function(a){a=a.split(".");for(var m="",j=a.length,w=0;w<j;w++)var s=a[w],m=2==s.length?m+("0"+s):m+s;return c.tablesorter.formatFloat(m)},type:"numeric"});j.addParser({id:"url",is:function(a){return/^(https?|ftp|file):\/\/$/.test(a)},format:function(a){return jQuery.trim(a.replace(RegExp(/(https?|ftp|file):\/\//),""))},type:"text"});j.addParser({id:"isoDate",is:function(a){return/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(a)},format:function(a){return c.tablesorter.formatFloat(""!=a?(new Date(a.replace(RegExp(/-/g),"/"))).getTime():"0")},type:"numeric"});j.addParser({id:"percent",is:function(a){return/\%$/.test(c.trim(a))},format:function(a){return c.tablesorter.formatFloat(a.replace(RegExp(/%/g),""))},type:"numeric"});j.addParser({id:"usLongDate",is:function(a){return a.match(RegExp(/^[A-Za-z]{3,10}\.? [0-9]{1,2}, ([0-9]{4}|'?[0-9]{2}) (([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(AM|PM)))$/))},format:function(a){return c.tablesorter.formatFloat((new Date(a)).getTime())},type:"numeric"});j.addParser({id:"shortDate",is:function(a){return/\d{1,2}[\/\-]\d{1,2}[\/\-]\d{2,4}/.test(a)},format:function(a,m){var j=m.config;a=a.replace(/\-/g,"/");if("us"==j.dateFormat)a=a.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$1/$2");else if("uk"==j.dateFormat)a=a.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{4})/,"$3/$2/$1");else if("dd/mm/yy"==j.dateFormat||"dd-mm-yy"==j.dateFormat)a=a.replace(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{2})/,"$1/$2/$3");return c.tablesorter.formatFloat((new Date(a)).getTime())},type:"numeric"});j.addParser({id:"time",is:function(a){return/^(([0-2]?[0-9]:[0-5][0-9])|([0-1]?[0-9]:[0-5][0-9]\s(am|pm)))$/.test(a)},format:function(a){return c.tablesorter.formatFloat((new Date("2000/01/01 "+a)).getTime())},type:"numeric"});j.addParser({id:"metadata",is:function(){return!1},format:function(a,j,r){a=j.config;a=!a.parserMetadataName?"sortValue":a.parserMetadataName;return c(r).metadata()[a]},type:"numeric"});j.addWidget({id:"zebra",format:function(a){if(a.config.debug)var j=new Date;var r,w=-1,s;c("tr:visible",a.tBodies[0]).each(function(){r=c(this);r.hasClass(a.config.cssChildRow)||w++;s=0==w%2;r.removeClass(a.config.widgetZebra.css[s?0:1]).addClass(a.config.widgetZebra.css[s?1:0])});a.config.debug&&c.tablesorter.benchmark("Applying Zebra widget",
j)}})})(jQuery);